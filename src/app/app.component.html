<mat-toolbar color="primary" id="header">
  <span>Slope Calculator</span>
  <span class="spacer"></span>
  <button mat-icon-button id="options-button" (click)="openSettingsDialog()" matTooltip="Configure settings">
    <mat-icon>settings</mat-icon>
  </button>
</mat-toolbar>

<div id="main">
  <mat-card class="card">
    <div id="instruction-text">
      <p>Use inputs or sliders to adjust values in the table below.</p>
      <p><i>Options for the sliders and table can be adjusted by clicking the settings icon in the upper right-hand corner.</i></p>
    </div>
    <div id="inputs-container">
      <div id="y1-input">
        <div class="variable-container">
          <mat-form-field class="variable-form-field auto-width">
            <mat-label>Elevation (Y1)</mat-label>
            <input matInput class="variable-input" [disabled]="lockedVariable === 'y1'" required
                   [ngModel]="y1" (ngModelChange)="updateY1($event)" />
            <mat-icon matSuffix class="lock-icon" [ngClass]="{ locked: lockedVariable === 'y1' }"
                      (click)="lock('y1')">{{ lockedVariable === 'y1' ? 'lock' : 'lock_open' }}</mat-icon>
          </mat-form-field>
          <div class="slider-container">
            <mat-slider class="variable-slider" [min]="settings.slider.y1.min" [max]="settings.slider.y1.max"
                        [step]="settings.slider.y1.step">
              <input matSliderThumb [disabled]="lockedVariable === 'y1'"
                     [ngModel]="y1" (ngModelChange)="updateY1($event)">
            </mat-slider>
          </div>
        </div>
      </div>

      <div id="y2-input">
        <div class="variable-container">
          <mat-form-field class="variable-form-field auto-width">
            <mat-label>Elevation (Y2)</mat-label>
            <input matInput class="variable-input" [disabled]="lockedVariable === 'y2'" required
                   [ngModel]="y2" (ngModelChange)="updateY2($event)" />
            <mat-icon matSuffix class="lock-icon" [ngClass]="{ locked: lockedVariable === 'y2' }"
                      (click)="lock('y2')">{{ lockedVariable === 'y2' ? 'lock' : 'lock_open' }}</mat-icon>
          </mat-form-field>
          <div class="slider-container">
            <mat-slider class="variable-slider" [min]="settings.slider.y2.min" [max]="settings.slider.y2.max"
                        [step]="settings.slider.y2.step">
              <input matSliderThumb [disabled]="lockedVariable === 'y2'"
                     [ngModel]="y2" (ngModelChange)="updateY2($event)">
            </mat-slider>
          </div>
        </div>
      </div>

      <div id="x-input">
        <div class="variable-container">
          <mat-form-field class="variable-form-field auto-width">
            <mat-label>Length (X)</mat-label>
            <input matInput class="variable-input" [disabled]="lockedVariable === 'x'" required
                   [ngModel]="x" (ngModelChange)="updateX($event)" />
            <mat-icon matSuffix class="lock-icon" [ngClass]="{ locked: lockedVariable === 'x' }"
                      (click)="lock('x')">{{ lockedVariable === 'x' ? 'lock' : 'lock_open' }}</mat-icon>
          </mat-form-field>
          <div class="slider-container">
            <mat-slider class="variable-slider" [min]="settings.slider.x.min" [max]="settings.slider.x.max"
                        [step]="settings.slider.x.step">
              <input matSliderThumb [disabled]="lockedVariable === 'x'"
                     [ngModel]="x" (ngModelChange)="updateX($event)">
            </mat-slider>
          </div>
        </div>
      </div>

      <div id="slope-input">
        <div class="variable-container">
          <div class="slope-container">
            <mat-form-field class="slope-form-field auto-width">
              <mat-label>Slope Min (%)</mat-label>
              <input matInput class="slope-input" required
                     [ngModel]="minSlope" (ngModelChange)="updateMinSlope($event)" />
            </mat-form-field>
            <mat-form-field class="slope-form-field auto-width">
              <mat-label>Slope Max (%)</mat-label>
              <input matInput class="slope-input" required
                     [ngModel]="maxSlope" (ngModelChange)="updateMaxSlope($event)" />
            </mat-form-field>
          </div>
          <div class="slider-container">
            <mat-slider class="variable-slider" [min]="settings.slider.slope.min" [max]="settings.slider.slope.max"
                        [step]="settings.slider.slope.step">
              <input matSliderStartThumb [ngModel]="minSlope" (ngModelChange)="updateMinSlope($event)">
              <input matSliderEndThumb [ngModel]="maxSlope" (ngModelChange)="updateMaxSlope($event)">
            </mat-slider>
          </div>
        </div>
      </div>
    </div>

    <div id="table-container" *ngIf="tableRows.length > 0">
      <table mat-table [dataSource]="tableRows">

        <ng-container matColumnDef="y1">
          <th mat-header-cell *matHeaderCellDef class="table-cell"> Elevation (Y1) </th>
          <td mat-cell *matCellDef="let item" class="table-cell"> {{ item.y1 | number:'1.0-2' }} </td>
        </ng-container>

        <ng-container matColumnDef="y2">
          <th mat-header-cell *matHeaderCellDef class="table-cell"> Elevation (Y2) </th>
          <td mat-cell *matCellDef="let item" class="table-cell"> {{ item.y2 | number:'1.0-2' }} </td>
        </ng-container>

        <ng-container matColumnDef="x">
          <th mat-header-cell *matHeaderCellDef class="table-cell"> Length (X) </th>
          <td mat-cell *matCellDef="let item" class="table-cell"> {{ item.x | number:'1.0-2' }} </td>
        </ng-container>

        <ng-container matColumnDef="slope">
          <th mat-header-cell *matHeaderCellDef class="table-cell"> Slope (%) </th>
          <td mat-cell *matCellDef="let item" class="table-cell"> {{ (item.slope * 100) | number:'1.0-2' }} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="table-header-row"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="table-row"></tr>
      </table>
    </div>
  </mat-card>
</div>

<footer>
  <div>&#169; {{ currentYear }}. All rights reserved.</div>
</footer>
